<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hjemmesiden med arrangementer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="HomepageStyle.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <!--Hentet fra https://fonts.google.com/icons?selected=Material+Icons-->

</head>
<body>
<div class="smartphone bakgrunnsfarge">
    <div class="content">
        <!-- filterknapp -->
        <div>
            <select id="filterMeny" onchange="filterActivity()">
                <option value="all"> Alle </option>
                <option value="sport"> Sport </option>
                <option value="study"> Study </option>
                <option value="social"> Social </option>
                <option value="party"> Party </option>
                <option value="festival"> Festival </option>
            </select>

            <p id="skrivUt"></p>
        </div>

        <div id="main"> <!-- tom div som blir fyllt av url-events -->
        </div>


        <!-- Navbar -->
        <nav class="nav">
            <a href="hovedside.html" class="NavKnapp active">
                <span class="material-icons">home</span> <!--Bilde ikone på navbaren-->
                <span class="IconName">Homepage</span> <!--Navnet på navbar knappene-->

            </a>
            <a href="addEvent.html" class="NavKnapp">
                <span class="material-icons">add_box</span> <!--Bilde ikone på navbaren-->
                <span class="IconName">Add Event</span> <!--Navnet på navbar knappene-->

            </a>
            <a href="#" class="NavKnapp">
                <span class="material-icons">favorite</span> <!--Bilde ikone på navbaren-->
                <span class="IconName">Favorites</span> <!--Navnet på navbar knappene-->

            </a>
            <a href="profile.html" class="NavKnapp">
                <span class="material-icons">account_box</span> <!--Bilde ikone på navbaren-->
                <span class="IconName">Profile</span> <!--Navnet på navbar knappene-->
            </a>
        </nav>
    </div> <!--Div-elementet for Mobilinnholdet lukkes-->
</div> <!--Hentet fra w3schools, link:https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_device_smartphone -->





<script>

let events = []

const urler = ['https://bacit.info/hwr/20211102062705-e7160661b36297c442204af72e640318.json',
    'https://bacit.info/hwr/20211102075440-f43946d975a0cde3f7cd84f8f59820dd.json',
    'https://bacit.info/hwr/20211102075752-700e1829bae5b8e969f9e0b8a48f4d1b.json',
    'https://bacit.info/hwr/20211102080220-e9f67ba52459de2ebbf9e489f42e1751.json'
]

Promise.all( //w3schools.com/js/js_promise.asp,   IKKE ASYNC
    urler.map( //kartlegger alle linkene i 'urler' for å fetche de (nedenfor) https://www.w3schools.com/jsref/jsref_map.asp
        (url) =>
            fetch(url)
                .then((res) => res.json())
                .then((res) => events.push(res)) //dytter inn dataen i events arrayen (som du kan se øverst i console.loggen)
    )
)
.then(() => {
    console.log(events) //logger objektene/personene fra brukerData i konsollen
    events.forEach(object => makeEventCards(object)) //for hver event i listen "events" -> lag div/event på homepage
})

.catch((err) => {
    alert('Feil ved innhenting av data') // Alert("error") viser hva som kommer opp dersom det er en error, inne i alert("") kan det stå hva som helst, men det må være forstålig, derfor valgte vi error
})


function filterActivity(){
    const activity = document.getElementById("filterMeny").value;
    const eventer = document.getElementsByClassName("eventDiv");

    for (let e of eventer) {
        if (e.classList[1] === activity || activity === "all"){
            e.style.display = "block";
        } else {
            e.style.display = "none";
        }
    }


}

function makeEventCards(object){ //funskjon for å lage event boksene på hjemme-siden
    let title = object.eventTitle;                                      //"object.eventTitle" henter eventen(object) sin tittel(.eventTitle)
    let category = object.category;
    let date = object.date;
    let campus = object.city;
    let info = object.eventInfo;
    let people = object.nop;
    let address = object.address;

    console.log(object)

    let eventDiv = document.createElement("div");                   //lager tom div
    eventDiv.setAttribute('class', 'eventDiv ' + category);         //gir class til div-en, både for styling og "category" for filtrering

    let table = document.createElement("table");                    //genererer tabellen alt ligger i
    table.setAttribute('class', 'eventsTable');

    let tr = document.createElement("tr");                          //hoved-raden alt ligger i

    let tdDato = document.createElement("td");                      //venstre kolonne
    tdDato.style.width = "25%";
    tdDato.innerHTML = date;                                  //legger inn text/verdi (object.date) i venstre kolonne

    let tdTitle = document.createElement("td");                     //midterste kolonne
    tdTitle.setAttribute('class', 'eventbarriere')
    tdTitle.innerHTML = title;


    let tdRight = document.createElement("td");                     //høyre kolonne
    tdRight.style.width = "25%";

    let tableRight = document.createElement("table");               //ny tabell (for å ha flere rader), som vi skal putte i høyre kolonne
    tableRight.setAttribute('class', 'eventsTableRight')

    let trCampus = document.createElement("tr");                    //de forskjellige radene som skal være i høyre kolonne
    let tdCampus = document.createElement("td");                    //lager kolonne for raden, dette må til selvom det bare er én kolonne per rad
    tdCampus.innerHTML = campus;
    trCampus.appendChild(tdCampus)                                  //her "appender" vi tdCampus kolonnen inn i trCampus raden. Append/appendchild legger/putter bakerste-nevnt "child" inn i "parent" sitt scope
                                                                    //altså: trCampus(parent) .append (tdCampus(child)) blir tdCampus lagt inn som en indent i scopet til trCampus (se modell/prototype nedenfor)
    let trCategory = document.createElement("tr");
    let tdCategory = document.createElement("td");
    tdCategory.innerHTML = category;
    trCategory.appendChild(tdCategory)

    let trPeople = document.createElement("tr");
    let tdPeople = document.createElement("td");
    tdPeople.innerHTML = people;
    trPeople.appendChild(tdPeople)

    //her starter append, se prototype nedenfor for oversikt over scopes
    tableRight.append(trCampus, trCategory, trPeople)               //appender campus, categori og deltagere inn i høyre kolonne-tabell
    tdRight.appendChild(tableRight)                                 //appender høyre kolonne-tabell inn i kolonnen
    tr.append(tdDato, tdTitle, tdRight);                            //appender dato, tittel og høyre kolonne inn i raden (dekker hele diven)
    table.appendChild(tr);                                          //appender raden i hoved-tabellen
    eventDiv.appendChild(table);                                    //appender tabellen inn i div-en
    document.getElementById("main").appendChild(eventDiv);          //appender div inn i "main" div (altså hoved-parten av homescreen
}

/*<div class="events elementBakgrunnsfarge">                 prototype av event boks         |  nøkkelord for makeEventCards()
    <table class="eventsTable">                                                                 table
        <tr>                                                                                        tr
            <td style="width: 25%"> dato</td>                                                           tdDate
            <td class="eventbarriere"> en lang tittel med masse tekst</td>                              tdTitle
            <td style="width: 25%">                                                                     tdRight
                <table class="eventsTableRight">                                                            tableRight
                    <tr>                                                                                        trCampus
                        <td> campus</td>                                                                            tdCampus
                    </tr>
                    <tr>                                                                                        trCategory
                        <td> kategori</td>
                    </tr>
                    <tr>                                                                                        trPeople
                        <td> deltagere</td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</div>*/

/*urler.forEach(renderJSON);
    //Skriver ut data på canvaser for en JSON fil.
    async function renderJSON(item) {
        //hente json fra serveren
        await fetch(item, {cache: 'no-cache'})
            .then(response => response.json())
            .then(data => {
                events.push(data)
            })
    }*/
</script>
</body>
</html>